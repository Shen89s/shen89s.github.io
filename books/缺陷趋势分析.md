# 缺陷趋势分析
## 概念&定义：
缺陷趋势是指“随着测试时间的进行,测试发现的缺陷趋势和开发解决缺陷的趋势”。

## 作用&意义：
我们进行此项分析的重要原因在于:缺陷趋势分析能够帮助我们判断当前系统是否还能很容易地发现缺陷,进而帮我们确定是否可以退出测试,发布产品。

## 方法：绘制缺陷趋势图
进行缺陷趋势分析的第一步是绘制缺陷趋势分析图。
方法很简单,我们只需要记录每天“发现的缺陷数”和“解决的缺陷数”,并由此算出每天“累积发现的缺陷数”和“累积解决的缺陷数”即可。   
口  累积发现的缺陷数:从开始测试到现在,测试团队发现的缺陷总数。   
口  新发现的缺陷数:测试团队当天新发现的缺陷总数。   
口  累积解决的缺陷数:从开始测试到现在,经测试确认已经被正确修复了的缺陷总数。   
口  当前解决的缺陷数:当天新被测试确认已经被正确修复了的缺陷总数。   
<table>
	<tr>
		<th>测试时间</th>
		<th>新发现缺陷数</th>
		<th>累积发现缺陷数</th>
		<th>新解决缺陷数</th>
		<th>累积解决缺陷数</th>
	</tr>
	<tr>
		<td>2018-01-01</td>
		<td>10</td>
		<td>150</td>
		<td>7</td>
		<td>120</td>
	</tr>
	<tr>
		<td>2018-01-02</td>
		<td>11</td>
		<td>161</td>
		<td>9</td>
		<td>129</td>
	</tr>
	<tr>
		<td>2018-01-03</td>
		<td>16</td>
		<td>177</td>
		<td>12</td>
		<td>141</td>
	</tr>
	<tr>
		<td>2018-01-04</td>
		<td>12</td>
		<td>189</td>
		<td>12</td>
		<td>153</td>
	</tr>
	<tr>
		<td>2018-01-05</td>
		<td>8</td>
		<td>197</td>
		<td>11</td>
		<td>164</td>
	</tr>	
		<tr>
		<td>2018-01-06</td>
		<td>2</td>
		<td>202</td>
		<td>16</td>
		<td>194</td>
	</tr>
</table>
将记录的缺陷趋势分析表绘制成图，即完成缺陷趋势图的绘制。    
![](https://shen89s.github.io/resFiles/r2/缺陷趋势分析图.jpg)   
在绘制过程中部要忘记去掉节假日、周末公休等未实际测试的工作日。绘制好缺陷趋势图以后，接下来的工作就是缺陷趋势分析了。   
下面我们主要以累积发现缺陷数和累积解决缺陷数为对象，分析变化趋势。其实缺陷趋势分析对象有很多，比如还有重新提起，未修复等等，不同的分析对象可以得出不同的测试隐含信息。

## 分析：
### 趋势图的“凹凸性”和拐点
数学中对曲线趋势进行分析时,会用到“凹凸性”和“拐点”的概念。
简单来说,拥有凹函数特性的曲线,呈现出递增的变化趋势;拥有凸函数特性的曲线,呈现出递减的变化趋势;而拐点就是凹函数和凸函数中间的连接点,即函数的变化趋势出现改变的点。这里我们借用数学里的概念，来对缺陷趋势进行定性分析，如图：   
![](https://shen89s.github.io/resFiles/凹凸性和拐点.jpg)

### 理想的变化趋势
以“累积发现缺陷趋势”为例，在理想情况下，我们希望“累积发现缺陷趋势”曲线随着测试时间，在不同的测试阶段，呈现如图所示的变化趋势。   
![](https://shen89s.github.io/resFiles/理想的变化趋势.jpg)

口  在一个新的测试阶段开始的时候，希望“累积发现缺陷的趋势”为凹函数，如图①，这说明测试人员每天发现的缺陷呈现越来越多的趋势，当前的测试策略（测试投入、测试方法）能够有效的发现产品的缺陷，且还可能发现大量的缺陷。   
口  在测试策略不变的情况下，测试一段时间后，出现拐点。说明当前测试方法已不能有效的发现系统中的缺陷，测试一段时间后，当前测试可以按照计划结束，进入下一阶段的测试。这里强调一下测试策略不变的重要性。例如，测试投入减少，也会导致“拐点”的出现，有时根据经验判断“拐点”过早的出现了，我们可以调整测试策略，来达到测试目标，而不是准备结束测试进入下一阶段的测试。   
口  完成阶段测试内容和测试目标以后，开始进入下一阶段的测试。由于不同的阶段测试策略不同，对于测试策略进行更新后，“累积发现缺陷趋势”又变为凹函数，出现拐点2 如图②

### 过早出现拐点趋势
以“累积发现缺陷趋势”为例，很多时候我们会发现，拐点比预期出现的要早，如图，以虚线表示理想，以实线表示产品实际测试情况。   
在测试阶段1里，拐点1的出现意味着，在进入阶段2之前很长的一段时间里，已经无法有效的发现产品的缺陷了，出现这种情况，可能的原因有：   
口  测试团队投入发生了变化，比如人员减少或者人员置换能力虚弱，并且直接影响到了当前阶段的测试。   
口  测试发生了阻塞，如产品质量差，存在会阻塞测试的严重缺陷，如测试环境出现问题，测试用例执行阻塞，无法有效的开展测试活动。   
口  测试策略不当，当前的测试方法已经无法再有效的发现缺陷。   

显然,无论是上述哪种情况,只要我们“对症下药”,有针对性地更新测试策略,都能有效地解决上述的问题。   
例如,第一种情况我们可以想办法调整测试的人力投入,使其更为合理;第二种情况我们只需要确定并清除造成阻塞的原因即可。    
判断问题是否被有效解决的方法也比较简单:分析“累积发现的缺陷趋势”曲线是否从凸函数变为凹函数的拐点,
如图是否出现“拐点2”所示(以“虚线”表示“理想的情况,实线表示实际项目中的情况)。
![](https://shen89s.github.io/resFiles/分析拐点.jpg)

### 拐点未出现趋势
以“累积发现缺陷趋势”为例，理想的拐点一直未出现，如图所示，以“虚线”表示理想的情况，“实线”表示产品实际测试情况。
![](https://shen89s.github.io/resFiles/拐点未出现.jpg)

拐点未出现，说明测试执行依然可以发现产品的大量缺陷。出现这种情况，可能的原因：       
口  测试执行未按照测试策略进行测试，可能使用了更多、更复杂的方法来发现产品的缺陷。   
口  版本质量太差，缺陷密度高于预期。   

分析第一种情况，可能这个团队的测试人员水平比较不错，如掌握的测试方法比较多，对产品业务掌握也比较好，测试人员比较有激情，测试人员抛开测试策略，更加主动的去发现系统更多的问题，测试效率也比较高，版本质量也相对比较好，虽然发现了很多问题，但没有出现测试阻塞。（测试架构师和测试经理需要仔细核对测试计划，确认测试人员在保证了测试计划的前提下才进行了发挥测试，这可能会比较尴尬，但我们的核心理念是进行刚刚好的测试，例如我们制定的产品质量目标是演示，而现在测试人员进行发挥测试，如果在这之前还未完成计划的测试任务，只是为了发现产品的更多缺陷，就远离了我们的测试目标。）   
如果确认发现测试计划和测试策略存在偏差，需要及时进行补充，并和测试人员做好沟通。

分析第二个种情况，如果是版本质量太差可以考虑从如下几个方面更新后续测试策略：      
口  增加相关内容的测试用例执行次数。   
口  增强相关内容的回归测试。   
口  对发现的缺陷进行逆向分析，增加探索式测试。   

注：版本质量太差通常进行测试打回出来，对应打回次数过多的版本，上述方法依然可行。

### 缺陷收敛趋势
我们在判断缺陷趋势是否收敛时,需要具备以下两个条件,缺一不可，如图：   
口  “累积发现的缺陷趋势”变为凸函数。   
口  “累积发现的缺陷趋势”和“累积解决的缺陷趋势”两条曲线越来越近，最后逐渐趋于一点。   
![](https://shen89s.github.io/resFiles/判断缺陷趋势是否收敛.jpg)

缺陷收敛说明当前测试已经不能有效发现问题,并且发现的缺陷也已经被有效修复。   
每完成一个阶段的测试，如集成测试、系统测试,都需要进行一次缺陷收敛分析,以确认是否满足该阶段测试的出入口条件。此外,缺陷收敛还是我们最后判断测试是否能够退出的必要条件——，即便按照计划,测试时间已经到了,如果缺陷不收敛,也不应该退出测试,发布产品。


下述的2中情况都不算缺陷收敛。

#### 未收敛1：两条缺陷未出现越来越靠近的趋势
![](https://shen89s.github.io/resFiles/非缺陷收敛1.jpg)

这时虽然累积发现的缺陷趋势为凸函数，但两条曲线未出现越来越近的趋势，最主要的问题在于开发还有较多的缺陷需要修复,测试还有较多的缺陷需要验证。   
我们不应该忽视缺陷修复带来的代码改动或引入的新问题。缺陷验证、回归测试和基于缺陷的探索式测试都可能再发现一些新的缺陷,甚至迎来新一轮的“缺陷小高峰”,“累积发现的缺陷趋势”出现新的“拐点”。因此我们可以认为有限、可控的代码改动是缺陷收敛的必要条件。当我们发现缺陷不收敛时,做好代码改动方面的控制,是一个很好的思路。   
口  严格控制代码改动,非必要不改动。   
口  做好代码的静态检查。   
口  做好和修改相关的功能自测,避免因为缺陷修改而引入新的问题。   

#### 未收敛2：累积发现的缺陷趋势不是凸函数
![](https://shen89s.github.io/resFiles/非缺陷收敛2.jpg)

这时虽然两条曲线出现越来越近的趋势，但累积发现缺陷趋势为凹函数，最主要的问题是测试人员还能大连发现产品的缺陷。曲线越来越近是一件好事，因为它能说明开发修复缺陷的速度还是蛮快的。




